
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cocaine Connectivity Data PCA &#8212; NeuroAnalysis</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="NeuroAnalysis" href="introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">NeuroAnalysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Cocaine Connectivity Data PCA
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/PCA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FPCA.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/executablebooks/jupyter-book/edit/master/docs/PCA.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/PCA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/docs/PCA.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-2-component-pca">
   Running 2 component PCA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-4-component-pca">
   Running 4 component PCA
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="cocaine-connectivity-data-pca">
<h1>Cocaine Connectivity Data PCA<a class="headerlink" href="#cocaine-connectivity-data-pca" title="Permalink to this headline">Â¶</a></h1>
<p>Description of data:<br />
Time (s): 0 ~ 1799 per recording</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core</span> <span class="kn">import</span> <span class="n">display</span> <span class="k">as</span> <span class="n">ICD</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] loading data...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#loading csv file </span>
<span class="n">multisite_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;drive/My Drive/Projects/pilot_mouse_connectivity/cocaine_two_mice/Spectrogram_data/updated_data/multisite_averaged_data.csv&#39;</span><span class="p">)</span>

<span class="n">ICD</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] loading data...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>-56.501194</td>
      <td>-58.404691</td>
      <td>-53.796707</td>
      <td>-54.683450</td>
      <td>-50.765295</td>
      <td>-49.201600</td>
      <td>-47.156084</td>
      <td>-47.257051</td>
      <td>-37.099407</td>
      <td>-37.333310</td>
      <td>-35.815629</td>
      <td>-36.039001</td>
      <td>31.250000</td>
      <td>1</td>
      <td>0</td>
      <td>0.461047</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>-55.990462</td>
      <td>-58.988152</td>
      <td>-54.108313</td>
      <td>-53.480236</td>
      <td>-49.899241</td>
      <td>-49.516848</td>
      <td>-45.858436</td>
      <td>-48.210181</td>
      <td>-40.991329</td>
      <td>-42.757552</td>
      <td>-36.514741</td>
      <td>-38.500080</td>
      <td>-40.040267</td>
      <td>1</td>
      <td>1</td>
      <td>0.482850</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>-56.533964</td>
      <td>-56.703969</td>
      <td>-53.713006</td>
      <td>-53.388769</td>
      <td>-47.988294</td>
      <td>-47.911166</td>
      <td>-45.839712</td>
      <td>-44.819948</td>
      <td>-36.329574</td>
      <td>-36.786060</td>
      <td>-34.261496</td>
      <td>-38.705199</td>
      <td>-46.110695</td>
      <td>1</td>
      <td>2</td>
      <td>0.490247</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>-55.088293</td>
      <td>-57.277582</td>
      <td>-54.759970</td>
      <td>-53.832872</td>
      <td>-49.272411</td>
      <td>-47.161322</td>
      <td>-46.172072</td>
      <td>-46.595272</td>
      <td>-37.772853</td>
      <td>-33.544189</td>
      <td>-36.755222</td>
      <td>-39.528779</td>
      <td>-41.637959</td>
      <td>1</td>
      <td>3</td>
      <td>0.485528</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>-56.064453</td>
      <td>-56.391981</td>
      <td>-54.370658</td>
      <td>-54.151737</td>
      <td>-48.075181</td>
      <td>-44.963544</td>
      <td>-47.350350</td>
      <td>-44.067891</td>
      <td>-41.780323</td>
      <td>-37.090223</td>
      <td>-37.366601</td>
      <td>-36.990245</td>
      <td>-39.613447</td>
      <td>1</td>
      <td>4</td>
      <td>0.494177</td>
      <td>post</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] dropping &#39;Unnamed: 0&#39; column...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
<span class="n">multisite_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ICD</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] dropping &#39;Unnamed: 0&#39; column...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-56.501194</td>
      <td>-58.404691</td>
      <td>-53.796707</td>
      <td>-54.683450</td>
      <td>-50.765295</td>
      <td>-49.201600</td>
      <td>-47.156084</td>
      <td>-47.257051</td>
      <td>-37.099407</td>
      <td>-37.333310</td>
      <td>-35.815629</td>
      <td>-36.039001</td>
      <td>31.250000</td>
      <td>1</td>
      <td>0</td>
      <td>0.461047</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-55.990462</td>
      <td>-58.988152</td>
      <td>-54.108313</td>
      <td>-53.480236</td>
      <td>-49.899241</td>
      <td>-49.516848</td>
      <td>-45.858436</td>
      <td>-48.210181</td>
      <td>-40.991329</td>
      <td>-42.757552</td>
      <td>-36.514741</td>
      <td>-38.500080</td>
      <td>-40.040267</td>
      <td>1</td>
      <td>1</td>
      <td>0.482850</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-56.533964</td>
      <td>-56.703969</td>
      <td>-53.713006</td>
      <td>-53.388769</td>
      <td>-47.988294</td>
      <td>-47.911166</td>
      <td>-45.839712</td>
      <td>-44.819948</td>
      <td>-36.329574</td>
      <td>-36.786060</td>
      <td>-34.261496</td>
      <td>-38.705199</td>
      <td>-46.110695</td>
      <td>1</td>
      <td>2</td>
      <td>0.490247</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-55.088293</td>
      <td>-57.277582</td>
      <td>-54.759970</td>
      <td>-53.832872</td>
      <td>-49.272411</td>
      <td>-47.161322</td>
      <td>-46.172072</td>
      <td>-46.595272</td>
      <td>-37.772853</td>
      <td>-33.544189</td>
      <td>-36.755222</td>
      <td>-39.528779</td>
      <td>-41.637959</td>
      <td>1</td>
      <td>3</td>
      <td>0.485528</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-56.064453</td>
      <td>-56.391981</td>
      <td>-54.370658</td>
      <td>-54.151737</td>
      <td>-48.075181</td>
      <td>-44.963544</td>
      <td>-47.350350</td>
      <td>-44.067891</td>
      <td>-41.780323</td>
      <td>-37.090223</td>
      <td>-37.366601</td>
      <td>-36.990245</td>
      <td>-39.613447</td>
      <td>1</td>
      <td>4</td>
      <td>0.494177</td>
      <td>post</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="s1">&#39;[INFO] getting information on the data...&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;[INFO] getting information on the data...&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multisite_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 14400 entries, 0 to 14399
Data columns (total 18 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   PFC gamma        14400 non-null  float64
 1   VTA gamma        14400 non-null  float64
 2   BLA gamma        14400 non-null  float64
 3   NAc gamma        14400 non-null  float64
 4   PFC beta         14400 non-null  float64
 5   VTA beta         14400 non-null  float64
 6   BLA beta         14400 non-null  float64
 7   NAc beta         14400 non-null  float64
 8   PFC theta        14400 non-null  float64
 9   VTA theta        14400 non-null  float64
 10  BLA theta        14400 non-null  float64
 11  NAc theta        14400 non-null  float64
 12  reference wires  7200 non-null   float64
 13  mouse id         14400 non-null  int64  
 14  Time (s)         14400 non-null  int64  
 15  Speed (cm/s)     14399 non-null  float64
 16  cocaine status   14400 non-null  object 
 17  recording        14400 non-null  int64  
dtypes: float64(14), int64(3), object(1)
memory usage: 2.0+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multisite_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>7200.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14399.000000</td>
      <td>14400.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-54.811637</td>
      <td>-56.846061</td>
      <td>-55.961131</td>
      <td>-55.798637</td>
      <td>-48.159617</td>
      <td>-49.001847</td>
      <td>-47.883579</td>
      <td>-48.442821</td>
      <td>-38.243090</td>
      <td>-38.322204</td>
      <td>-38.461431</td>
      <td>-38.774405</td>
      <td>-56.379793</td>
      <td>1.500000</td>
      <td>899.500000</td>
      <td>6.688596</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.068423</td>
      <td>2.352484</td>
      <td>4.713378</td>
      <td>3.505149</td>
      <td>2.950827</td>
      <td>2.893824</td>
      <td>5.451147</td>
      <td>3.621962</td>
      <td>4.121070</td>
      <td>3.733250</td>
      <td>6.142054</td>
      <td>4.473741</td>
      <td>18.233053</td>
      <td>0.500017</td>
      <td>519.633205</td>
      <td>7.822517</td>
      <td>0.500017</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-62.967683</td>
      <td>-64.722694</td>
      <td>-67.979530</td>
      <td>-67.626881</td>
      <td>-57.557590</td>
      <td>-58.086337</td>
      <td>-62.919179</td>
      <td>-61.141950</td>
      <td>-57.748825</td>
      <td>-54.368922</td>
      <td>-59.110206</td>
      <td>-55.570155</td>
      <td>-89.470184</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-56.387963</td>
      <td>-58.299689</td>
      <td>-58.432244</td>
      <td>-57.016779</td>
      <td>-50.345994</td>
      <td>-51.035358</td>
      <td>-51.110122</td>
      <td>-49.866365</td>
      <td>-40.839729</td>
      <td>-40.866794</td>
      <td>-42.222446</td>
      <td>-41.092209</td>
      <td>-82.724009</td>
      <td>1.000000</td>
      <td>449.750000</td>
      <td>1.164009</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-54.541846</td>
      <td>-57.145421</td>
      <td>-53.902102</td>
      <td>-54.786533</td>
      <td>-48.060410</td>
      <td>-49.510781</td>
      <td>-45.915615</td>
      <td>-47.786480</td>
      <td>-38.302393</td>
      <td>-38.879714</td>
      <td>-36.376327</td>
      <td>-38.043777</td>
      <td>-46.910281</td>
      <td>1.500000</td>
      <td>899.500000</td>
      <td>3.520864</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>-53.394415</td>
      <td>-55.446176</td>
      <td>-52.687571</td>
      <td>-53.380062</td>
      <td>-46.273530</td>
      <td>-47.395109</td>
      <td>-44.063579</td>
      <td>-46.073310</td>
      <td>-35.584788</td>
      <td>-36.101646</td>
      <td>-34.150518</td>
      <td>-35.940170</td>
      <td>-43.731854</td>
      <td>2.000000</td>
      <td>1349.250000</td>
      <td>9.663074</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>-31.735852</td>
      <td>-23.039573</td>
      <td>-33.301535</td>
      <td>-38.456308</td>
      <td>-22.255495</td>
      <td>-22.977058</td>
      <td>-22.722149</td>
      <td>-28.808064</td>
      <td>-13.607474</td>
      <td>-16.428050</td>
      <td>-16.403773</td>
      <td>-18.287559</td>
      <td>31.250000</td>
      <td>2.000000</td>
      <td>1799.000000</td>
      <td>46.229302</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] filling NaN values with average...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">multisite_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ICD</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] filling NaN values with average...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-56.501194</td>
      <td>-58.404691</td>
      <td>-53.796707</td>
      <td>-54.683450</td>
      <td>-50.765295</td>
      <td>-49.201600</td>
      <td>-47.156084</td>
      <td>-47.257051</td>
      <td>-37.099407</td>
      <td>-37.333310</td>
      <td>-35.815629</td>
      <td>-36.039001</td>
      <td>31.250000</td>
      <td>1</td>
      <td>0</td>
      <td>0.461047</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-55.990462</td>
      <td>-58.988152</td>
      <td>-54.108313</td>
      <td>-53.480236</td>
      <td>-49.899241</td>
      <td>-49.516848</td>
      <td>-45.858436</td>
      <td>-48.210181</td>
      <td>-40.991329</td>
      <td>-42.757552</td>
      <td>-36.514741</td>
      <td>-38.500080</td>
      <td>-40.040267</td>
      <td>1</td>
      <td>1</td>
      <td>0.482850</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-56.533964</td>
      <td>-56.703969</td>
      <td>-53.713006</td>
      <td>-53.388769</td>
      <td>-47.988294</td>
      <td>-47.911166</td>
      <td>-45.839712</td>
      <td>-44.819948</td>
      <td>-36.329574</td>
      <td>-36.786060</td>
      <td>-34.261496</td>
      <td>-38.705199</td>
      <td>-46.110695</td>
      <td>1</td>
      <td>2</td>
      <td>0.490247</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-55.088293</td>
      <td>-57.277582</td>
      <td>-54.759970</td>
      <td>-53.832872</td>
      <td>-49.272411</td>
      <td>-47.161322</td>
      <td>-46.172072</td>
      <td>-46.595272</td>
      <td>-37.772853</td>
      <td>-33.544189</td>
      <td>-36.755222</td>
      <td>-39.528779</td>
      <td>-41.637959</td>
      <td>1</td>
      <td>3</td>
      <td>0.485528</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-56.064453</td>
      <td>-56.391981</td>
      <td>-54.370658</td>
      <td>-54.151737</td>
      <td>-48.075181</td>
      <td>-44.963544</td>
      <td>-47.350350</td>
      <td>-44.067891</td>
      <td>-41.780323</td>
      <td>-37.090223</td>
      <td>-37.366601</td>
      <td>-36.990245</td>
      <td>-39.613447</td>
      <td>1</td>
      <td>4</td>
      <td>0.494177</td>
      <td>post</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] scaling the region columns...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># set new df</span>
<span class="n">scaled_df</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:]</span>

<span class="c1"># set scare obj</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaled_df</span><span class="p">[[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span>
           <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">,</span> <span class="s1">&#39;reference wires&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">scaled_df</span><span class="p">[[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span>
                                                                                                       <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span>
                                                                                                       <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">,</span> <span class="s1">&#39;reference wires&#39;</span><span class="p">]])</span>
       
<span class="n">ICD</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">scaled_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] scaling the region columns...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.207048</td>
      <td>0.151572</td>
      <td>0.408986</td>
      <td>0.443715</td>
      <td>0.192405</td>
      <td>0.253060</td>
      <td>0.392146</td>
      <td>0.429423</td>
      <td>0.467802</td>
      <td>0.449004</td>
      <td>0.545458</td>
      <td>0.523868</td>
      <td>1.000000</td>
      <td>1</td>
      <td>0</td>
      <td>0.461047</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.223401</td>
      <td>0.137575</td>
      <td>0.400001</td>
      <td>0.484963</td>
      <td>0.216938</td>
      <td>0.244080</td>
      <td>0.424428</td>
      <td>0.399945</td>
      <td>0.379633</td>
      <td>0.306039</td>
      <td>0.529088</td>
      <td>0.457856</td>
      <td>0.409459</td>
      <td>1</td>
      <td>1</td>
      <td>0.482850</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.205999</td>
      <td>0.192373</td>
      <td>0.411400</td>
      <td>0.488098</td>
      <td>0.271069</td>
      <td>0.289814</td>
      <td>0.424894</td>
      <td>0.504796</td>
      <td>0.485242</td>
      <td>0.463428</td>
      <td>0.581849</td>
      <td>0.452355</td>
      <td>0.359173</td>
      <td>1</td>
      <td>2</td>
      <td>0.490247</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.252287</td>
      <td>0.178612</td>
      <td>0.381209</td>
      <td>0.472874</td>
      <td>0.234694</td>
      <td>0.311172</td>
      <td>0.416625</td>
      <td>0.449890</td>
      <td>0.452546</td>
      <td>0.548873</td>
      <td>0.523457</td>
      <td>0.430264</td>
      <td>0.396224</td>
      <td>1</td>
      <td>3</td>
      <td>0.485528</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.221032</td>
      <td>0.199858</td>
      <td>0.392435</td>
      <td>0.461943</td>
      <td>0.268608</td>
      <td>0.373770</td>
      <td>0.387313</td>
      <td>0.528055</td>
      <td>0.361758</td>
      <td>0.455411</td>
      <td>0.509141</td>
      <td>0.498353</td>
      <td>0.412994</td>
      <td>1</td>
      <td>4</td>
      <td>0.494177</td>
      <td>post</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] setting the x input variable...&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">scaled_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span>
       <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] setting the x input variable...
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_pca</span><span class="p">(</span><span class="n">n_components</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] setting the PCA model and fitting with x...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

  <span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
  <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span>
  <span class="n">principalComponents</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PCA model: </span><span class="se">\n</span><span class="si">%s</span><span class="s2"> </span><span class="se">\n\n</span><span class="s2">Principal Components: </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span><span class="n">principalComponents</span><span class="p">))</span>
  
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">PCA variance: &quot;</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">pca</span><span class="p">,</span> <span class="n">principalComponents</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_principalComponent_df</span><span class="p">(</span><span class="n">principalComponents</span><span class="p">,</span><span class="n">n_components</span><span class="p">,</span><span class="n">multisite_df</span><span class="p">):</span>

  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[INFO] making a datafame with principal compenents...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

  <span class="n">pc_list</span><span class="o">=</span><span class="p">[]</span>

  <span class="c1"># set the df column names</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_components</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">col_name</span> <span class="o">=</span> <span class="s2">&quot;principal component </span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">i</span>
    <span class="n">pc_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>

  <span class="n">principal_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">principalComponents</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span><span class="n">pc_list</span><span class="p">)</span>
  <span class="n">ICD</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">principal_df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[INFO] combining PC dataframe and the target...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="n">principal_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">principal_df</span><span class="p">,</span> <span class="n">multisite_df</span><span class="p">[[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">ICD</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">principal_df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

  <span class="k">return</span> <span class="n">principal_df</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">visualize_heatmap</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span><span class="n">cmap</span><span class="p">):</span>
  
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[INFO] visualizing heatmap...&#39;</span><span class="p">)</span>

  <span class="n">y_labelsA</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">y_labelsB</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%i</span><span class="s2">-Component PCA&quot;</span><span class="o">%</span><span class="k">n_components</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_components</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>

    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;PC </span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">i</span>
    <span class="n">y_labelsA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y_labelsB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label_name</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">y_labelsA</span><span class="p">,</span> <span class="n">y_labelsB</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
  <span class="c1">#plt.title(title)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">([</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span>
        <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">])),[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span>
        <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">],</span><span class="n">rotation</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-2-component-pca">
<h2>Running 2 component PCA<a class="headerlink" href="#running-2-component-pca" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca2</span><span class="p">,</span> <span class="n">principalComponents2</span> <span class="o">=</span> <span class="n">fit_pca</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pca2_df</span> <span class="o">=</span> <span class="n">make_principalComponent_df</span><span class="p">(</span><span class="n">principalComponents2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">multisite_df</span><span class="p">)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdPu&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] setting the PCA model and fitting with x...

PCA model: 
PCA(copy=True, iterated_power=&#39;auto&#39;, n_components=2, random_state=None,
    svd_solver=&#39;auto&#39;, tol=0.0, whiten=False) 

Principal Components: 
[[ 0.11039182 -0.05906303]
 [ 0.12719582 -0.06431592]
 [ 0.14984475 -0.0455044 ]
 ...
 [ 0.11111446 -0.06660845]
 [ 0.12038668 -0.03685936]
 [ 0.12380694  0.07562177]]

PCA variance:  [0.41514774 0.23475438]

[INFO] making a datafame with principal compenents...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>principal component 1</th>
      <th>principal component 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-2.704530e-17</td>
      <td>2.761786e-16</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.399463e-01</td>
      <td>1.804345e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-5.781281e-01</td>
      <td>-6.338429e-01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-2.243402e-01</td>
      <td>-9.909111e-02</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.098327e-01</td>
      <td>-5.813392e-02</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.860371e-01</td>
      <td>5.578822e-04</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.670712e-01</td>
      <td>7.503676e-01</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] combining PC dataframe and the target...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>principal component 1</th>
      <th>principal component 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-2.704530e-17</td>
      <td>2.761786e-16</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.399463e-01</td>
      <td>1.804345e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-5.781281e-01</td>
      <td>-6.338429e-01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-2.243402e-01</td>
      <td>-9.909111e-02</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.098327e-01</td>
      <td>-5.813392e-02</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.860371e-01</td>
      <td>5.578822e-04</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.670712e-01</td>
      <td>7.503676e-01</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] visualizing heatmap...
</pre></div>
</div>
<img alt="_images/PCA_15_5.png" src="_images/PCA_15_5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] visualizing principal components...&#39;</span><span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 2&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Principal Component Analysis&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="s1">&#39;pre&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;indigo&#39;</span><span class="p">,</span> <span class="s1">&#39;deeppink&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span><span class="n">colors</span><span class="p">):</span>
    <span class="n">indicesToKeep</span> <span class="o">=</span> <span class="n">pca2_df</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pca2_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indicesToKeep</span><span class="p">,</span> <span class="s1">&#39;principal component 1&#39;</span><span class="p">]</span>
               <span class="p">,</span> <span class="n">pca2_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indicesToKeep</span><span class="p">,</span> <span class="s1">&#39;principal component 2&#39;</span><span class="p">]</span>
               <span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">color</span>
               <span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] visualizing principal components...
</pre></div>
</div>
<img alt="_images/PCA_16_1.png" src="_images/PCA_16_1.png" />
</div>
</div>
</div>
<div class="section" id="running-4-component-pca">
<h2>Running 4 component PCA<a class="headerlink" href="#running-4-component-pca" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca4</span><span class="p">,</span> <span class="n">principalComponents4</span> <span class="o">=</span> <span class="n">fit_pca</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pca4_df</span> <span class="o">=</span> <span class="n">make_principalComponent_df</span><span class="p">(</span><span class="n">principalComponents4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">multisite_df</span><span class="p">)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;twilight_shifted&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] setting the PCA model and fitting with x...

PCA model: 
PCA(copy=True, iterated_power=&#39;auto&#39;, n_components=4, random_state=None,
    svd_solver=&#39;auto&#39;, tol=0.0, whiten=False) 

Principal Components: 
[[ 0.11039182 -0.05906303  0.01788757 -0.08929888]
 [ 0.12719582 -0.06431592 -0.11241014  0.02256033]
 [ 0.14984475 -0.0455044   0.07825732  0.0075555 ]
 ...
 [ 0.11111446 -0.06660845 -0.16190964 -0.03679915]
 [ 0.12038668 -0.03685936 -0.3225607  -0.10355397]
 [ 0.12380694  0.07562177 -0.16043037 -0.03825978]]

PCA variance:  [0.41514774 0.23475438 0.1923754  0.04265356]

[INFO] making a datafame with principal compenents...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>principal component 1</th>
      <th>principal component 2</th>
      <th>principal component 3</th>
      <th>principal component 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-3.345029e-17</td>
      <td>2.677825e-16</td>
      <td>-1.517498e-17</td>
      <td>-4.043062e-17</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.399463e-01</td>
      <td>1.804345e-01</td>
      <td>1.633381e-01</td>
      <td>7.691134e-02</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-5.781281e-01</td>
      <td>-6.338429e-01</td>
      <td>-5.236496e-01</td>
      <td>-3.450161e-01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-2.243402e-01</td>
      <td>-9.909111e-02</td>
      <td>-1.075333e-01</td>
      <td>-4.727147e-02</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.098327e-01</td>
      <td>-5.813392e-02</td>
      <td>-2.133858e-02</td>
      <td>-2.472790e-04</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.860371e-01</td>
      <td>5.578822e-04</td>
      <td>7.893992e-02</td>
      <td>5.066465e-02</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.670712e-01</td>
      <td>7.503676e-01</td>
      <td>1.379992e+00</td>
      <td>5.663717e-01</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] combining PC dataframe and the target...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>principal component 1</th>
      <th>principal component 2</th>
      <th>principal component 3</th>
      <th>principal component 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
      <td>1.440000e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-3.345029e-17</td>
      <td>2.677825e-16</td>
      <td>-1.517498e-17</td>
      <td>-4.043062e-17</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.399463e-01</td>
      <td>1.804345e-01</td>
      <td>1.633381e-01</td>
      <td>7.691134e-02</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-5.781281e-01</td>
      <td>-6.338429e-01</td>
      <td>-5.236496e-01</td>
      <td>-3.450161e-01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-2.243402e-01</td>
      <td>-9.909111e-02</td>
      <td>-1.075333e-01</td>
      <td>-4.727147e-02</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.098327e-01</td>
      <td>-5.813392e-02</td>
      <td>-2.133858e-02</td>
      <td>-2.472790e-04</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.860371e-01</td>
      <td>5.578822e-04</td>
      <td>7.893992e-02</td>
      <td>5.066465e-02</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.670712e-01</td>
      <td>7.503676e-01</td>
      <td>1.379992e+00</td>
      <td>5.663717e-01</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] visualizing heatmap...
</pre></div>
</div>
<img alt="_images/PCA_18_5.png" src="_images/PCA_18_5.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="introduction.html" title="previous page">NeuroAnalysis</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Nichollette Taylor Acosta<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>