
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Decoding Cocaine Brainwave Connectivity &#8212; NeuroAnalysis</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Connectome-based Predictive Modeling (CPM)" href="cpm_bevel.html" />
    <link rel="prev" title="Cocaine Connectivity Data PCA" href="PCA.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">NeuroAnalysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="PCA.html">
   Cocaine Connectivity Data PCA
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Decoding Cocaine Brainwave Connectivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cpm_bevel.html">
   Connectome-based Predictive Modeling (CPM)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/decoding_brainwaves.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdecoding_brainwaves.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/executablebooks/jupyter-book/edit/master/docs/decoding_brainwaves.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/decoding_brainwaves.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/docs/decoding_brainwaves.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preparation">
   Data Preparation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decoding-gamma">
   Decoding Gamma
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decoding-beta">
   Decoding Beta
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decoding-theta">
   Decoding Theta
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decoding-with-all-regions-and-waves">
   Decoding with all regions and waves
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decoding-by-regions">
   Decoding by Regions
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="decoding-cocaine-brainwave-connectivity">
<h1>Decoding Cocaine Brainwave Connectivity<a class="headerlink" href="#decoding-cocaine-brainwave-connectivity" title="Permalink to this headline">¶</a></h1>
<p>do these plots by region with pre and post cocaine (like NAcc on top pre and NAcc on cocaine on bottom)?  Just for Beta and theta  but for all four regions on sperate graphs?</p>
<p>Currently: 2 subjects (mice), 2 recordings (1-2), 2 tasks (pre-cocaine, post-cocaine).<br />
Time per recording: 0-1799 seconds</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] mounting google drive directory...</span><span class="se">\n</span><span class="s2">[INFO] if prompted follow the link and copy and paste the token.&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] mounting google drive directory...
[INFO] if prompted follow the link and copy and paste the token.
Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] installing nilearn for session...&quot;</span><span class="p">)</span>
<span class="o">!</span>pip install nilearn
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] installing nilearn for session...
Requirement already satisfied: nilearn in /usr/local/lib/python3.6/dist-packages (0.6.2)
Requirement already satisfied: scikit-learn&gt;=0.19 in /usr/local/lib/python3.6/dist-packages (from nilearn) (0.22.2.post1)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.6/dist-packages (from nilearn) (0.14.1)
Requirement already satisfied: scipy&gt;=0.19 in /usr/local/lib/python3.6/dist-packages (from nilearn) (1.4.1)
Requirement already satisfied: numpy&gt;=1.11 in /usr/local/lib/python3.6/dist-packages (from nilearn) (1.18.4)
Requirement already satisfied: sklearn in /usr/local/lib/python3.6/dist-packages (from nilearn) (0.0)
Requirement already satisfied: nibabel&gt;=2.0.2 in /usr/local/lib/python3.6/dist-packages (from nilearn) (3.0.2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import packages </span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="kn">from</span> <span class="nn">IPython.core</span> <span class="kn">import</span> <span class="n">display</span> <span class="k">as</span> <span class="n">ICD</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">nilearn</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">cross_val_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setting color dictionaries for maps</span>

<span class="n">post_color_dict</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">:</span><span class="s1">&#39;violet&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">:</span><span class="s1">&#39;plum&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">:</span><span class="s1">&#39;mediumorchid&#39;</span><span class="p">,</span>
             <span class="s1">&#39;PFC beta&#39;</span><span class="p">:</span> <span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">:</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">:</span><span class="s1">&#39;turquoise&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;NAc beta&#39;</span><span class="p">:</span><span class="s1">&#39;deepskyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">:</span> <span class="s1">&#39;limegreen&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">:</span><span class="s1">&#39;palegreen&#39;</span><span class="p">,</span>
             <span class="s1">&#39;BLA theta&#39;</span><span class="p">:</span> <span class="s1">&#39;yellowgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">:</span><span class="s1">&#39;olive&#39;</span><span class="p">}</span>

<span class="n">pre_color_dict</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">:</span> <span class="s1">&#39;dimgray&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">:</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">:</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">:</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>
             <span class="s1">&#39;PFC beta&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">:</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">:</span><span class="s1">&#39;indianred&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;NAc beta&#39;</span><span class="p">:</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">:</span> <span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">:</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span>
             <span class="s1">&#39;BLA theta&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">:</span><span class="s1">&#39;yellow&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="data-preparation">
<h2>Data Preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the data file into a data frame </span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] loading the multisite brainwave connectivity data into a dataframe now...&#39;</span><span class="p">)</span>
<span class="n">multisite_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;drive/My Drive/Projects/pilot_mouse_connectivity/cocaine_two_mice/Spectrogram_data/updated_data/multisite_averaged_data.csv&#39;</span><span class="p">)</span>

<span class="n">multisite_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] loading the multisite brainwave connectivity data into a dataframe now...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>-56.501194</td>
      <td>-58.404691</td>
      <td>-53.796707</td>
      <td>-54.683450</td>
      <td>-50.765295</td>
      <td>-49.201600</td>
      <td>-47.156084</td>
      <td>-47.257051</td>
      <td>-37.099407</td>
      <td>-37.333310</td>
      <td>-35.815629</td>
      <td>-36.039001</td>
      <td>31.250000</td>
      <td>1</td>
      <td>0</td>
      <td>0.461047</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>-55.990462</td>
      <td>-58.988152</td>
      <td>-54.108313</td>
      <td>-53.480236</td>
      <td>-49.899241</td>
      <td>-49.516848</td>
      <td>-45.858436</td>
      <td>-48.210181</td>
      <td>-40.991329</td>
      <td>-42.757552</td>
      <td>-36.514741</td>
      <td>-38.500080</td>
      <td>-40.040267</td>
      <td>1</td>
      <td>1</td>
      <td>0.482850</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>-56.533964</td>
      <td>-56.703969</td>
      <td>-53.713006</td>
      <td>-53.388769</td>
      <td>-47.988294</td>
      <td>-47.911166</td>
      <td>-45.839712</td>
      <td>-44.819948</td>
      <td>-36.329574</td>
      <td>-36.786060</td>
      <td>-34.261496</td>
      <td>-38.705199</td>
      <td>-46.110695</td>
      <td>1</td>
      <td>2</td>
      <td>0.490247</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>-55.088293</td>
      <td>-57.277582</td>
      <td>-54.759970</td>
      <td>-53.832872</td>
      <td>-49.272411</td>
      <td>-47.161322</td>
      <td>-46.172072</td>
      <td>-46.595272</td>
      <td>-37.772853</td>
      <td>-33.544189</td>
      <td>-36.755222</td>
      <td>-39.528779</td>
      <td>-41.637959</td>
      <td>1</td>
      <td>3</td>
      <td>0.485528</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>-56.064453</td>
      <td>-56.391981</td>
      <td>-54.370658</td>
      <td>-54.151737</td>
      <td>-48.075181</td>
      <td>-44.963544</td>
      <td>-47.350350</td>
      <td>-44.067891</td>
      <td>-41.780323</td>
      <td>-37.090223</td>
      <td>-37.366601</td>
      <td>-36.990245</td>
      <td>-39.613447</td>
      <td>1</td>
      <td>4</td>
      <td>0.494177</td>
      <td>post</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># drop unneccesary first column</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;INFO] cleaning data...&#39;</span><span class="p">)</span>

<span class="n">multisite_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">multisite_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO] cleaning data...
[&#39;PFC gamma&#39; &#39;VTA gamma&#39; &#39;BLA gamma&#39; &#39;NAc gamma&#39; &#39;PFC beta&#39; &#39;VTA beta&#39;
 &#39;BLA beta&#39; &#39;NAc beta&#39; &#39;PFC theta&#39; &#39;VTA theta&#39; &#39;BLA theta&#39; &#39;NAc theta&#39;
 &#39;reference wires&#39; &#39;mouse id&#39; &#39;Time (s)&#39; &#39;Speed (cm/s)&#39; &#39;cocaine status&#39;
 &#39;recording&#39;]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-56.501194</td>
      <td>-58.404691</td>
      <td>-53.796707</td>
      <td>-54.683450</td>
      <td>-50.765295</td>
      <td>-49.201600</td>
      <td>-47.156084</td>
      <td>-47.257051</td>
      <td>-37.099407</td>
      <td>-37.333310</td>
      <td>-35.815629</td>
      <td>-36.039001</td>
      <td>31.250000</td>
      <td>1</td>
      <td>0</td>
      <td>0.461047</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-55.990462</td>
      <td>-58.988152</td>
      <td>-54.108313</td>
      <td>-53.480236</td>
      <td>-49.899241</td>
      <td>-49.516848</td>
      <td>-45.858436</td>
      <td>-48.210181</td>
      <td>-40.991329</td>
      <td>-42.757552</td>
      <td>-36.514741</td>
      <td>-38.500080</td>
      <td>-40.040267</td>
      <td>1</td>
      <td>1</td>
      <td>0.482850</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-56.533964</td>
      <td>-56.703969</td>
      <td>-53.713006</td>
      <td>-53.388769</td>
      <td>-47.988294</td>
      <td>-47.911166</td>
      <td>-45.839712</td>
      <td>-44.819948</td>
      <td>-36.329574</td>
      <td>-36.786060</td>
      <td>-34.261496</td>
      <td>-38.705199</td>
      <td>-46.110695</td>
      <td>1</td>
      <td>2</td>
      <td>0.490247</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-55.088293</td>
      <td>-57.277582</td>
      <td>-54.759970</td>
      <td>-53.832872</td>
      <td>-49.272411</td>
      <td>-47.161322</td>
      <td>-46.172072</td>
      <td>-46.595272</td>
      <td>-37.772853</td>
      <td>-33.544189</td>
      <td>-36.755222</td>
      <td>-39.528779</td>
      <td>-41.637959</td>
      <td>1</td>
      <td>3</td>
      <td>0.485528</td>
      <td>post</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-56.064453</td>
      <td>-56.391981</td>
      <td>-54.370658</td>
      <td>-54.151737</td>
      <td>-48.075181</td>
      <td>-44.963544</td>
      <td>-47.350350</td>
      <td>-44.067891</td>
      <td>-41.780323</td>
      <td>-37.090223</td>
      <td>-37.366601</td>
      <td>-36.990245</td>
      <td>-39.613447</td>
      <td>1</td>
      <td>4</td>
      <td>0.494177</td>
      <td>post</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Factorize categorical data</strong></p>
<p>Here we create a new column “cocaine status num”, that holds 0 if the true label is post cocaine, and 1 if the true label is pre cocaine.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] factorizing target variable: cocaine status ...&#39;</span><span class="p">)</span>
<span class="c1"># turn cocaine category labels into numerics, 0: post and 1: pre</span>
<span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] factorizing target variable: cocaine status ...
</pre></div>
</div>
</div>
</div>
<p><strong>Fill in NaN values with average</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] filling missing data with average ...&#39;</span><span class="p">)</span>
<span class="n">multisite_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] view data ...&#39;</span><span class="p">)</span>
<span class="n">multisite_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] filling missing data with average ...
[INFO] view data ...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
      <th>cocaine status num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14395</th>
      <td>-57.945512</td>
      <td>-60.610124</td>
      <td>-54.832686</td>
      <td>-54.930917</td>
      <td>-53.453498</td>
      <td>-54.694912</td>
      <td>-48.215670</td>
      <td>-54.100591</td>
      <td>-45.402066</td>
      <td>-43.293175</td>
      <td>-41.552947</td>
      <td>-44.923270</td>
      <td>-56.379793</td>
      <td>1</td>
      <td>1795</td>
      <td>1.145819</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14396</th>
      <td>-57.283914</td>
      <td>-61.857844</td>
      <td>-53.046077</td>
      <td>-56.369021</td>
      <td>-53.506348</td>
      <td>-52.885991</td>
      <td>-44.472734</td>
      <td>-46.909043</td>
      <td>-36.616661</td>
      <td>-43.950709</td>
      <td>-33.409286</td>
      <td>-38.811592</td>
      <td>-56.379793</td>
      <td>1</td>
      <td>1796</td>
      <td>0.167269</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14397</th>
      <td>-57.621165</td>
      <td>-62.037227</td>
      <td>-54.470172</td>
      <td>-56.285570</td>
      <td>-50.645157</td>
      <td>-48.306280</td>
      <td>-46.802928</td>
      <td>-46.783425</td>
      <td>-46.357364</td>
      <td>-41.330419</td>
      <td>-36.800070</td>
      <td>-37.888468</td>
      <td>-56.379793</td>
      <td>1</td>
      <td>1797</td>
      <td>0.155295</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14398</th>
      <td>-59.532244</td>
      <td>-61.890011</td>
      <td>-54.634515</td>
      <td>-54.805142</td>
      <td>-51.794797</td>
      <td>-54.021217</td>
      <td>-47.390373</td>
      <td>-51.180051</td>
      <td>-48.041564</td>
      <td>-42.124833</td>
      <td>-35.664824</td>
      <td>-40.147725</td>
      <td>-56.379793</td>
      <td>1</td>
      <td>1798</td>
      <td>0.004777</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14399</th>
      <td>-58.429392</td>
      <td>-62.086589</td>
      <td>-54.455730</td>
      <td>-56.122061</td>
      <td>-47.567010</td>
      <td>-49.108323</td>
      <td>-46.107437</td>
      <td>-52.037337</td>
      <td>-41.694312</td>
      <td>-42.653839</td>
      <td>-33.130993</td>
      <td>-40.041810</td>
      <td>-56.379793</td>
      <td>1</td>
      <td>1799</td>
      <td>0.000000</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Normalize data</strong><br />
Here the brainwave data is being scaled.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] scaling brainwave data down ...&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">multisite_df</span><span class="p">[[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span>
       <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span>
       <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">,</span> <span class="s1">&#39;reference wires&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">multisite_df</span><span class="p">[[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span>
                                                                                                       <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span>
                                                                                                       <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">,</span> <span class="s1">&#39;reference wires&#39;</span><span class="p">]])</span>
       
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] Scaled data:&#39;</span><span class="p">)</span>
<span class="n">multisite_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] scaling brainwave data down ...
[INFO] Scaled data:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
      <th>cocaine status num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14395</th>
      <td>0.160803</td>
      <td>0.098663</td>
      <td>0.379112</td>
      <td>0.435232</td>
      <td>0.116256</td>
      <td>0.096596</td>
      <td>0.365786</td>
      <td>0.217770</td>
      <td>0.279710</td>
      <td>0.291921</td>
      <td>0.411115</td>
      <td>0.285573</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1795</td>
      <td>1.145819</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14396</th>
      <td>0.181986</td>
      <td>0.068729</td>
      <td>0.430632</td>
      <td>0.385932</td>
      <td>0.114759</td>
      <td>0.148119</td>
      <td>0.458901</td>
      <td>0.440185</td>
      <td>0.478738</td>
      <td>0.274591</td>
      <td>0.601804</td>
      <td>0.449501</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1796</td>
      <td>0.167269</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14397</th>
      <td>0.171188</td>
      <td>0.064426</td>
      <td>0.389566</td>
      <td>0.388793</td>
      <td>0.195808</td>
      <td>0.278560</td>
      <td>0.400931</td>
      <td>0.444070</td>
      <td>0.258068</td>
      <td>0.343653</td>
      <td>0.522407</td>
      <td>0.474261</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1797</td>
      <td>0.155295</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14398</th>
      <td>0.109998</td>
      <td>0.067958</td>
      <td>0.384827</td>
      <td>0.439544</td>
      <td>0.163242</td>
      <td>0.115785</td>
      <td>0.386317</td>
      <td>0.308095</td>
      <td>0.219913</td>
      <td>0.322715</td>
      <td>0.548989</td>
      <td>0.413663</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1798</td>
      <td>0.004777</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14399</th>
      <td>0.145310</td>
      <td>0.063242</td>
      <td>0.389982</td>
      <td>0.394398</td>
      <td>0.283002</td>
      <td>0.255716</td>
      <td>0.418233</td>
      <td>0.281581</td>
      <td>0.363707</td>
      <td>0.308772</td>
      <td>0.608321</td>
      <td>0.416504</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1799</td>
      <td>0.000000</td>
      <td>pre</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Create a dataframe that holds the regions averaged across waves</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_avg_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;NAc&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;NAc*&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;PFC&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;PFC*&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;VTA&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;VTA*&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;BLA&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;BLA*&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;reference wires&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;reference wires&#39;</span><span class="p">]</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;mouse id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;mouse id&#39;</span><span class="p">]</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">]</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;Speed (cm/s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;Speed (cm/s)&#39;</span><span class="p">]</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span>
<span class="n">region_avg_df</span><span class="p">[</span><span class="s1">&#39;recording&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;recording&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_avg_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAc</th>
      <th>PFC</th>
      <th>VTA</th>
      <th>BLA</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>cocaine status</th>
      <th>recording</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14395</th>
      <td>0.312858</td>
      <td>0.185590</td>
      <td>0.162393</td>
      <td>0.385338</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1795</td>
      <td>1.145819</td>
      <td>pre</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14396</th>
      <td>0.425206</td>
      <td>0.258495</td>
      <td>0.163813</td>
      <td>0.497112</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1796</td>
      <td>0.167269</td>
      <td>pre</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14397</th>
      <td>0.435708</td>
      <td>0.208355</td>
      <td>0.228880</td>
      <td>0.437635</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1797</td>
      <td>0.155295</td>
      <td>pre</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14398</th>
      <td>0.387100</td>
      <td>0.164384</td>
      <td>0.168819</td>
      <td>0.440044</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1798</td>
      <td>0.004777</td>
      <td>pre</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14399</th>
      <td>0.364161</td>
      <td>0.264006</td>
      <td>0.209243</td>
      <td>0.472179</td>
      <td>0.274108</td>
      <td>1</td>
      <td>1799</td>
      <td>0.000000</td>
      <td>pre</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] plotting gamma waves for single mouse, pre and post...&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>View quick statistics of our cleaned dataframe.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] dataframe description ...&#39;</span><span class="p">)</span>
<span class="n">multisite_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] dataframe description ...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>VTA gamma</th>
      <th>BLA gamma</th>
      <th>NAc gamma</th>
      <th>PFC beta</th>
      <th>VTA beta</th>
      <th>BLA beta</th>
      <th>NAc beta</th>
      <th>PFC theta</th>
      <th>VTA theta</th>
      <th>BLA theta</th>
      <th>NAc theta</th>
      <th>reference wires</th>
      <th>mouse id</th>
      <th>Time (s)</th>
      <th>Speed (cm/s)</th>
      <th>recording</th>
      <th>cocaine status num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
      <td>14400.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.261145</td>
      <td>0.188965</td>
      <td>0.346571</td>
      <td>0.405485</td>
      <td>0.266216</td>
      <td>0.258749</td>
      <td>0.374048</td>
      <td>0.392750</td>
      <td>0.441893</td>
      <td>0.422940</td>
      <td>0.483505</td>
      <td>0.450498</td>
      <td>0.274108</td>
      <td>1.500000</td>
      <td>899.500000</td>
      <td>6.688596</td>
      <td>1.500000</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.066228</td>
      <td>0.056437</td>
      <td>0.135918</td>
      <td>0.120160</td>
      <td>0.083588</td>
      <td>0.082423</td>
      <td>0.135611</td>
      <td>0.112018</td>
      <td>0.093361</td>
      <td>0.098397</td>
      <td>0.143820</td>
      <td>0.119995</td>
      <td>0.106795</td>
      <td>0.500017</td>
      <td>519.633205</td>
      <td>7.822245</td>
      <td>0.500017</td>
      <td>0.500017</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.210674</td>
      <td>0.154091</td>
      <td>0.275312</td>
      <td>0.363726</td>
      <td>0.204282</td>
      <td>0.200829</td>
      <td>0.293779</td>
      <td>0.348723</td>
      <td>0.383067</td>
      <td>0.355873</td>
      <td>0.395438</td>
      <td>0.388330</td>
      <td>0.274108</td>
      <td>1.000000</td>
      <td>449.750000</td>
      <td>1.164028</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.269784</td>
      <td>0.181783</td>
      <td>0.405947</td>
      <td>0.440182</td>
      <td>0.269026</td>
      <td>0.244253</td>
      <td>0.423005</td>
      <td>0.413049</td>
      <td>0.440549</td>
      <td>0.408246</td>
      <td>0.532329</td>
      <td>0.470095</td>
      <td>0.274108</td>
      <td>1.500000</td>
      <td>899.500000</td>
      <td>3.521444</td>
      <td>1.500000</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.306523</td>
      <td>0.222549</td>
      <td>0.440970</td>
      <td>0.488397</td>
      <td>0.319643</td>
      <td>0.304513</td>
      <td>0.469079</td>
      <td>0.466032</td>
      <td>0.502115</td>
      <td>0.481467</td>
      <td>0.584448</td>
      <td>0.526519</td>
      <td>0.352545</td>
      <td>2.000000</td>
      <td>1349.250000</td>
      <td>9.661078</td>
      <td>2.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1799.000000</td>
      <td>46.229302</td>
      <td>2.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Decoding Helper Functions</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## data prep helper function</span>
<span class="k">def</span> <span class="nf">dataSplit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x_target_columns</span><span class="p">,</span> <span class="n">y_target_columns</span><span class="p">):</span>
  <span class="c1"># prepare data for decoding</span>

  <span class="c1"># pull out target data with columns  </span>
  <span class="n">X</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">x_target_columns</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
  <span class="n">y</span><span class="o">=</span><span class="n">multisite_df</span><span class="p">[</span><span class="n">y_target_columns</span><span class="p">]</span>

  <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">;</span>

<span class="c1">## classifier helper function </span>
<span class="k">def</span> <span class="nf">svmModelBuilder</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] building </span><span class="si">%s</span><span class="s2"> SVM classifier&quot;</span><span class="o">%</span><span class="k">kernel</span>)

  <span class="c1"># build, fit and predict model</span>
  <span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
  <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] fit model for beta.&quot;</span><span class="p">)</span>
  <span class="n">y_pred</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] predicted model for beta.&quot;</span><span class="p">)</span>

  <span class="c1"># view metrics data</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[INFO] Model Metrics: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">clf</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">;</span>


<span class="c1">## nested CV helper function</span>
<span class="k">def</span> <span class="nf">nestedCVBuilder</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k_range</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]):</span>
  <span class="c1"># build grid pipeline and run cross validation</span>
  <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">k_range</span><span class="p">})</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] built grid pipeline,running nested cv...&quot;</span><span class="p">)</span>
  <span class="n">nested_cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO completed nested cross validation.&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nested CV score: </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">nested_cv_scores</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">grid</span><span class="p">,</span> <span class="n">nested_cv_scores</span><span class="p">;</span>

<span class="c1"># plot post and pre plots</span>
<span class="k">def</span> <span class="nf">plotBrainwavesStatus</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
  <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> pre-cocaine status&#39;</span><span class="o">%</span><span class="k">keyword</span>, fontsize=20)
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3600</span><span class="p">:</span><span class="mi">5399</span><span class="p">,</span> <span class="s1">&#39;Time (s)&#39;</span><span class="p">],</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3600</span><span class="p">:</span><span class="mi">5399</span><span class="p">,</span> <span class="n">wave</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">wave</span><span class="o">+</span><span class="s2">&quot;: pre&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> post-cocaine status&#39;</span><span class="o">%</span><span class="k">keyword</span>, fontsize=20)
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1799</span><span class="p">,</span> <span class="n">wave</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">wave</span><span class="o">+</span><span class="s2">&quot;: post&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">post_color_dict</span><span class="p">[</span><span class="n">wave</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">plotBrainWaves</span><span class="p">(</span><span class="n">precolor</span><span class="p">,</span> <span class="n">postcolor</span><span class="p">,</span> <span class="n">keyword</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

  <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">pre_color_dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">wave</span><span class="p">:</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1799</span><span class="p">,</span> <span class="n">wave</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">wave</span><span class="o">+</span><span class="s2">&quot;: post&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">precolor</span><span class="p">)</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3600</span><span class="p">:</span><span class="mi">5399</span><span class="p">,</span> <span class="s1">&#39;Time (s)&#39;</span><span class="p">],</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3600</span><span class="p">:</span><span class="mi">5399</span><span class="p">,</span> <span class="n">wave</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">wave</span><span class="o">+</span><span class="s2">&quot;: pre&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">postcolor</span><span class="p">)</span>

          <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Series Network, Mouse ID #1, recording 1, </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">keyword</span>)
          <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Wave Signal&#39;</span><span class="p">)</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">),</span>
          <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="decoding-gamma">
<h2>Decoding Gamma<a class="headerlink" href="#decoding-gamma" title="Permalink to this headline">¶</a></h2>
<p>Input X is the gamma brainwave data: <code class="docutils literal notranslate"><span class="pre">multisite_df[['PFC</span> <span class="pre">gamma',</span> <span class="pre">'VTA</span> <span class="pre">gamma',</span> <span class="pre">'BLA</span> <span class="pre">gamma',</span> <span class="pre">'NAc</span> <span class="pre">gamma']]</span></code>,<br />
target variable y is the <code class="docutils literal notranslate"><span class="pre">multisite_df['cocaine</span> <span class="pre">status</span> <span class="pre">num']</span></code></p>
<p>The numerical cocaine status translates as follows:  { 0: post, 1: pre }</p>
<p><strong>Quick Plotting brainwave signals</strong></p>
<p>Plot individual regions-</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] plotting regions...&quot;</span><span class="p">)</span>
<span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;PFC gamma&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] plotting regions...
</pre></div>
</div>
<img alt="_images/decoding_brainwaves_26_1.png" src="_images/decoding_brainwaves_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;NAc gamma&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_27_0.png" src="_images/decoding_brainwaves_27_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;BLA gamma&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_28_0.png" src="_images/decoding_brainwaves_28_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;VTA gamma&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_29_0.png" src="_images/decoding_brainwaves_29_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">[INFO] plotting pair plot of gamma waves:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">multisite_df</span><span class="p">[[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">]],</span><span class="n">diag_kind</span><span class="o">=</span><span class="s2">&quot;kde&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] plotting pair plot of gamma waves:
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7ff55f7f6e80&gt;
</pre></div>
</div>
<img alt="_images/decoding_brainwaves_30_2.png" src="_images/decoding_brainwaves_30_2.png" />
</div>
</div>
<p><strong>Prepare input data</strong></p>
<p><strong>Setup input X and target y</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare the input data </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] preparing data for decoding gamma...&#39;</span><span class="p">)</span>

<span class="c1"># set X input array, </span>
<span class="c1"># pull out the gamma columns from our dataframe and turn into numpy array</span>
<span class="n">X</span><span class="o">=</span><span class="n">multisite_df</span><span class="p">[[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X shape: &quot;</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># set y target variable </span>
<span class="n">y</span><span class="o">=</span><span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status num&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y shape: &quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] preparing data for decoding gamma...
X shape:  (14400, 4)
y shape:  (14400,)
</pre></div>
</div>
</div>
</div>
<p><strong>Split datasets</strong></p>
<p>Training, testing and validation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] splitting training dataset&quot;</span><span class="p">)</span>


<span class="n">X_train</span><span class="p">,</span> <span class="n">X_validate</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_validate</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.20</span><span class="p">)</span>

<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_validate</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_validate</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] splitting training dataset
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((11520, 4), (2880, 4), (11520,), (2880,))
</pre></div>
</div>
</div>
</div>
<p><strong>Create and fit the linear SVM classifier model</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] creating the svm linear model...&quot;</span><span class="p">)</span>
<span class="c1"># creater classifier model, svm</span>
<span class="n">gamma_svm</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">gamma_svm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] creating the svm linear model...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,
    decision_function_shape=&#39;ovr&#39;, degree=3, gamma=&#39;scale&#39;, kernel=&#39;linear&#39;,
    max_iter=-1, probability=False, random_state=None, shrinking=True,
    tol=0.001, verbose=False)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit model with training data</span>
<span class="n">gamma_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] fit model.&quot;</span><span class="p">)</span>
<span class="c1"># predict on validation data</span>
<span class="n">gamma_y_pred</span><span class="o">=</span><span class="n">gamma_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_validate</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] predicted model.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] fit model.
[INFO] predicted model.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] view metrics...&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_validate</span><span class="p">,</span><span class="n">gma_y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_validate</span><span class="p">,</span><span class="n">gma_y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] view metrics...
[[1016  413]
 [ 629  822]]
              precision    recall  f1-score   support

           0       0.62      0.71      0.66      1429
           1       0.67      0.57      0.61      1451

    accuracy                           0.64      2880
   macro avg       0.64      0.64      0.64      2880
weighted avg       0.64      0.64      0.64      2880
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] setting up nested cross validation pipeline...&quot;</span><span class="p">)</span>

<span class="c1"># set up nested CV pipeline with grid </span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">cross_val_score</span> 
<span class="n">k_range</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
<span class="n">gamma_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">gamma_svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">k_range</span><span class="p">},</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="n">gamma_nested_cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gamma_grid</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] Finished CV.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nested CV score: </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gamma_nested_cv_scores</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] setting up nested cross validation pipeline...
[INFO] Finished CV.
Nested CV score: 64.0712
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma_svm</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  8.55999732, -17.80293729,  -0.17427279,  -2.99872527]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="decoding-beta">
<h2>Decoding Beta<a class="headerlink" href="#decoding-beta" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] plotting regions for beta...&quot;</span><span class="p">)</span>
<span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;PFC beta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] plotting regions for beta...
</pre></div>
</div>
<img alt="_images/decoding_brainwaves_43_1.png" src="_images/decoding_brainwaves_43_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;NAc beta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_44_0.png" src="_images/decoding_brainwaves_44_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;BLA beta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_45_0.png" src="_images/decoding_brainwaves_45_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;VTA beta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_46_0.png" src="_images/decoding_brainwaves_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare data for decoding</span>
<span class="c1"># pull out beta columns  </span>
<span class="n">X</span><span class="o">=</span><span class="n">multisite_df</span><span class="p">[[</span><span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status num&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beta_svm</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="n">beta_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] fit model for beta.&quot;</span><span class="p">)</span>
<span class="n">y_pred</span><span class="o">=</span><span class="n">beta_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] predicted model for beta.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] fit model for beta.
[INFO] predicted model for beta.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] running nested cross validation on beta waves...&quot;</span><span class="p">)</span>

<span class="n">k_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
<span class="n">beta_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">beta_svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">k_range</span><span class="p">},</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="n">beta_nested_cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">beta_grid</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO completed nested cross validation.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nested CV score: </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">beta_nested_cv_scores</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] running nested cross validation on beta waves...
[INFO completed nested cross validation.
Nested CV score: 77.6481
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="decoding-theta">
<h2>Decoding Theta<a class="headerlink" href="#decoding-theta" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] plotting regions...&quot;</span><span class="p">)</span>
<span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;PFC theta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] plotting regions...
</pre></div>
</div>
<img alt="_images/decoding_brainwaves_53_1.png" src="_images/decoding_brainwaves_53_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;NAc theta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_54_0.png" src="_images/decoding_brainwaves_54_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;BLA theta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_55_0.png" src="_images/decoding_brainwaves_55_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotBrainWaves</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;VTA theta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_56_0.png" src="_images/decoding_brainwaves_56_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare data for decoding</span>
<span class="c1"># pull out theta columns  </span>
<span class="n">X</span><span class="o">=</span><span class="n">multisite_df</span><span class="p">[[</span><span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">,</span>
                <span class="s1">&#39;reference wires&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse id&#39;</span><span class="p">,</span> <span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="s1">&#39;Speed (cm/s)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status num&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] fitting classifier with theta waves...&quot;</span><span class="p">)</span>

<span class="n">theta_svm</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="n">theta_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] fit model for theta.&quot;</span><span class="p">)</span>
<span class="n">theta_y_pred</span><span class="o">=</span><span class="n">theta_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] predicted model for theta.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] fitting classifier with theta waves...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,
    decision_function_shape=&#39;ovr&#39;, degree=3, gamma=&#39;scale&#39;, kernel=&#39;rbf&#39;,
    max_iter=-1, probability=False, random_state=None, shrinking=True,
    tol=0.001, verbose=False)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] running cross validation on theta waves...&quot;</span><span class="p">)</span>
<span class="n">theta_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">theta_svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">k_range</span><span class="p">})</span>
<span class="n">theta_nested_cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">theta_grid</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO completed nested cross validation.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nested CV score: </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">theta_nested_cv_scores</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] running cross validation on theta waves...
[INFO completed nested cross validation.
Nested CV score: 85.1019
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="decoding-with-all-regions-and-waves">
<h2>Decoding with all regions and waves<a class="headerlink" href="#decoding-with-all-regions-and-waves" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_regions_df</span> <span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span>
 <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">,</span> <span class="s1">&#39;cocaine status num&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># full data decoding</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">pre_color_dict</span><span class="p">:</span>
       <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3600</span><span class="p">:</span><span class="mi">5399</span><span class="p">,</span> <span class="n">wave</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">post_color_dict</span><span class="p">[</span><span class="n">wave</span><span class="p">])</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Series Network, Mouse ID #1, recording 1 pre-cocaine&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Wave Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">post_color_dict</span><span class="p">:</span>
       <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1799</span><span class="p">,</span> <span class="n">wave</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">post_color_dict</span><span class="p">[</span><span class="n">wave</span><span class="p">])</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Series Network, Mouse ID #1, recording 1 post-cocaine&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Wave Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/decoding_brainwaves_64_0.png" src="_images/decoding_brainwaves_64_0.png" />
<img alt="_images/decoding_brainwaves_64_1.png" src="_images/decoding_brainwaves_64_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA beta&#39;</span><span class="p">,</span>
 <span class="s1">&#39;BLA beta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">,</span> <span class="s1">&#39;VTA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA theta&#39;</span><span class="p">,</span> <span class="s1">&#39;NAc theta&#39;</span><span class="p">]</span>
<span class="n">y_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cocaine status num&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="o">=</span><span class="n">dataSplit</span><span class="p">(</span><span class="n">all_regions_df</span><span class="p">,</span> <span class="n">x_cols</span><span class="p">,</span> <span class="n">y_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((10800, 12), (3600, 12), (10800, 1), (3600, 1))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">svmModelBuilder</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] building linear SVM classifier
[INFO] fit model for beta.
[INFO] predicted model for beta.

[INFO] Model Metrics: 

[[1596  197]
 [ 359 1448]]
              precision    recall  f1-score   support

           0       0.82      0.89      0.85      1793
           1       0.88      0.80      0.84      1807

    accuracy                           0.85      3600
   macro avg       0.85      0.85      0.85      3600
weighted avg       0.85      0.85      0.85      3600
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="p">,</span> <span class="n">nested_cv_scores</span><span class="o">=</span><span class="n">nestedCVBuilder</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] built grid pipeline,running nested cv...
[INFO completed nested cross validation.
Nested CV score: 85.9537
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="decoding-by-regions">
<h2>Decoding by Regions<a class="headerlink" href="#decoding-by-regions" title="Permalink to this headline">¶</a></h2>
<p><strong>PFC Region</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># region based decoding</span>
<span class="n">pfc_region</span><span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;PFC*&quot;</span><span class="p">))</span>
<span class="n">pfc_region</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span>
<span class="n">pfc_region</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PFC gamma</th>
      <th>PFC beta</th>
      <th>PFC theta</th>
      <th>cocaine status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.207048</td>
      <td>0.192405</td>
      <td>0.467802</td>
      <td>post</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.223401</td>
      <td>0.216938</td>
      <td>0.379633</td>
      <td>post</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.205999</td>
      <td>0.271069</td>
      <td>0.485242</td>
      <td>post</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.252287</td>
      <td>0.234694</td>
      <td>0.452546</td>
      <td>post</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.221032</td>
      <td>0.268608</td>
      <td>0.361758</td>
      <td>post</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pfc_region</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff55c756f28&gt;
</pre></div>
</div>
<img alt="_images/decoding_brainwaves_73_1.png" src="_images/decoding_brainwaves_73_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PFC gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC beta&#39;</span><span class="p">,</span> <span class="s1">&#39;PFC theta&#39;</span><span class="p">]</span>
<span class="n">y_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span>
<span class="n">pfc_region</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">multisite_df</span><span class="p">[</span><span class="s1">&#39;cocaine status num&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="o">=</span><span class="n">dataSplit</span><span class="p">(</span><span class="n">pfc_region</span><span class="p">,</span> <span class="n">x_cols</span><span class="p">,</span> <span class="n">y_cols</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((10800, 3), (3600, 3), (10800, 1), (3600, 1))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">svmModelBuilder</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] building linear SVM classifier
[INFO] fit model for beta.
[INFO] predicted model for beta.

[INFO] Model Metrics: 

[[1372  421]
 [ 461 1346]]
              precision    recall  f1-score   support

        post       0.75      0.77      0.76      1793
         pre       0.76      0.74      0.75      1807

    accuracy                           0.76      3600
   macro avg       0.76      0.76      0.75      3600
weighted avg       0.76      0.76      0.75      3600
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="p">,</span> <span class="n">nested_cv_scores</span><span class="o">=</span><span class="n">nestedCVBuilder</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO] built grid pipeline,running nested cv...
[INFO completed nested cross validation.
Nested CV score: 74.9352
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vta_region</span><span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;VTA*&quot;</span><span class="p">))</span>
<span class="n">vta_region</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nac_region</span><span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;NAc*&quot;</span><span class="p">))</span>
<span class="n">nac_region</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bla_region</span><span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;BLA*&quot;</span><span class="p">))</span>
<span class="n">bla_region</span><span class="p">[</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">multisite_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cocaine status&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="PCA.html" title="previous page">Cocaine Connectivity Data PCA</a>
    <a class='right-next' id="next-link" href="cpm_bevel.html" title="next page">Connectome-based Predictive Modeling (CPM)</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Nichollette Taylor Acosta<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>